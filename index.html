<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  <style>
    @media print {
      #form {
        display: none;
      }
    }
  </style>
</head>

<body>
  <div id="root"></div>
  <script type="text/babel">
    class Page extends React.Component {
      constructor(props) {
        super(props);
        this.state = {paper: "A4p", width: 297, height: 210, rows: 10, columns: 10};
        this.handleChange = this.handleChange.bind(this);
        this.handlePaperChange = this.handlePaperChange.bind(this);
      }

      handleChange(event) {
        this.setState({
          [event.target.name]: event.target.value,
          paper: event.target.name == "width" || event.target.name == "height" ? "None" : this.state.paper
        });
      }

      handlePaperChange(event) {
        let paper = {
          A4p: {paper: "A4p", width: 210, height: 297},
          A4l: {paper: "A4l", width: 297, height: 210},
          letterp: {paper: "letterp", width: 215.9, height: 279.4},
          letterl: {paper: "letterl", width: 279.4, height: 215.9},
        }
        this.setState(paper[event.target.value]);
      }

      render() {
        return <div>
            <div id="form">
              <p/>
              <form onSubmit={this.handleSubmit}>
                <label> Paper Size: 
                  <select value={this.state.paper} onChange={this.handlePaperChange}>
                    <option value="A4p">A4 portrait</option>
                    <option value="A4l">A4 landscape</option>
                    <option value="letterp">Letter portrait</option>
                    <option value="letterl">Letter landscape</option>
                    <option value="None"></option>
                  </select>
                </label>
                
                <label> Paper Width (mm): <input type="text" name="width" min="100" type="number" value={this.state.width} onChange={this.handleChange}/></label>
                <label> Paper Height (mm): <input type="text" name="height" min="100" type="number" value={this.state.height} onChange={this.handleChange}/></label>
                <label> Rows: <input type="text" name="rows" min="1" type="number" value={this.state.rows} onChange={this.handleChange}/></label>
                <label> Columns: <input type="text" name="columns" min="1" type="number" value={this.state.columns} onChange={this.handleChange}/></label>
              </form>
              <p/>
            </div>
            {this.state.width > 0 && this.state.height > 0 && this.state.columns > 0 && this.state.rows > 0 &&
              <RevenueTracker width={parseInt(this.state.width)} height={parseInt(this.state.height)} columns={parseInt(this.state.columns)} rows={parseInt(this.state.rows)}/>
            }
          </div>;
      }
    }

    function RevenueTracker(props) {
      const pageWidth = props.width;
      const pageHeight = props.height;
      const rows = props.rows;
      const columns = props.columns;

      const cellSize = Math.min(pageWidth / columns, pageHeight / rows);

      const xshift = (pageWidth - cellSize * columns) / 2;
      const yshift = (pageHeight - cellSize * rows) / 2;

      const cells = [];

      for(var y = 0; y < rows; y++) {
        for(var x = 0; x < columns; x++) {
          cells.push(<Rect x={x} y={y} i={x+y*columns} width={cellSize} xshift={xshift} yshift={yshift}/>);
        }
      }

      return (
      <svg width={props.width + "mm"} height={props.height + "mm"} version="1.1" xmlns="http://www.w3.org/2000/svg">
        {cells}
      </svg>);
    }

    function Rect(props) {
      const x = props.x * props.width + props.xshift;
      const y = props.y * props.width + props.yshift;
      return <g>
          <rect x={x + "mm"} y={y + "mm"} width={props.width + "mm"} height={props.width + "mm"} style={{fill:"rgb(255,255,255)",strokeWidth:3,stroke:"rgb(0,0,0)"}}/>;
          <line x1={(x + props.width * 3/4) + "mm"} y1={(y + props.width/2) + "mm"} x2={(x + props.width) + "mm"} y2={(y + props.width/2) + "mm"} width={props.width + "mm"} height={props.width + "mm"} style={{fill:"rgb(255,255,255)",strokeWidth:1,stroke:"rgb(0,0,0)"}}/>;

          <line x1={(x + props.width * 1/4) + "mm"} y1={(y + props.width * 4/5) + "mm"} x2={(x + props.width * 1/4) + "mm"} y2={(y + props.width) + "mm"} width={props.width + "mm"} height={props.width + "mm"} style={{fill:"rgb(255,255,255)",strokeWidth:1,stroke:"rgb(0,0,0)"}}/>;
          <line x1={(x + props.width * 2/4) + "mm"} y1={(y + props.width * 4/5) + "mm"} x2={(x + props.width * 2/4) + "mm"} y2={(y + props.width) + "mm"} width={props.width + "mm"} height={props.width + "mm"} style={{fill:"rgb(255,255,255)",strokeWidth:1,stroke:"rgb(0,0,0)"}}/>;
          <line x1={(x + props.width * 3/4) + "mm"} y1={(y + props.width * 4/5) + "mm"} x2={(x + props.width * 3/4) + "mm"} y2={(y + props.width) + "mm"} width={props.width + "mm"} height={props.width + "mm"} style={{fill:"rgb(255,255,255)",strokeWidth:1,stroke:"rgb(0,0,0)"}}/>;

          <text x={(x + props.width* 2/5) + "mm"} y={(y + props.width * 2/5) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 4) + "mm"} fontFamily="Verdana"> {props.i} </text>

          <text x={(props.width * 7 / 8 + x) + "mm"} y={(y + props.width*2/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana"> {props.i} </text>
          <text x={(props.width * 7 / 8 + x) + "mm"} y={(y + props.width*4/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana"> {props.i*2} </text>
          <text x={(props.width * 7 / 8 + x) + "mm"} y={(y + props.width*6/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana"> {props.i*3} </text>
          <text x={(props.width * 7 / 8 + x) + "mm"} y={(y + props.width*9/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana"> {props.i*4} </text>
          <text x={(props.width * 7 / 8 + x) + "mm"} y={(y + props.width*11/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana" style={{fill: "red"}}> {props.i*5} </text>
          <text x={(props.width * 7 / 8 + x) + "mm"} y={(y + props.width*13/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana"> {props.i*6} </text>
          <text x={(props.width * 5 / 8 + x) + "mm"} y={(y + props.width*13/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana"> {props.i*7} </text>
          <text x={(props.width * 3 / 8 + x) + "mm"} y={(y + props.width*13/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana"> {props.i*8} </text>
          <text x={(props.width * 1 / 8 + x) + "mm"} y={(y + props.width*13/15) + "mm"} dominantBaseline="middle" textAnchor="middle" fontSize={(props.width / 10) + "mm"} fontFamily="Verdana"> {props.i*9} </text>
        </g>
    }

    ReactDOM.render( <Page/>, document.getElementById('root'));

    </script>
</body>

</html>
